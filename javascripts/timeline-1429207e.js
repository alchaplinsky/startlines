(function(){window.Timeline=function(){function t(t,e,i){this.people=e,this.color=i,this.el=$(".timeline .container"),this.dates=_.map(t,function(t){return moment(t,"YYYY-MM-DD")}),this.start_date=_.first(this.dates),this.end_date=moment(),this.scale=this.end_date.diff(this.start_date)/(this.el.width()-15),this.initMobileBehavior(),this.initSlides(),this.initTimeline(),this.initEvents(),this.initPeople()}return t.prototype.initSlides=function(){return this.slides=new Slides},t.prototype.initEvents=function(){return $(document).on("click",".marker",function(t){return function(e){return t.slides.deck.slide(t.el.find(".marker").index(e.currentTarget))}}(this)),this.slides.deck.on("activate",function(t){return function(e){return t.markers.removeClass("current"),$(t.markers[e.index]).addClass("current")}}(this)),$(window).on("resize",function(t){return function(){return t.initMobileBehavior()}}(this))},t.prototype.initMobileBehavior=function(){var t;return $(window).width()<=840?(t=$("section").outerWidth()/2,$("section").css("margin-left","-"+t+"px")):void 0},t.prototype.initTimeline=function(){return this.el.attr("data-start",this.start_date.format("DD MMM, YYYY")),this.el.attr("data-end",this.end_date.format("DD MMM, YYYY")),_.each(this.dates,function(t){return function(e){var i;return i=$("<div class='marker' data-date='"+e.format("DD MMM, YYYY")+"' style='background: "+t.color+"'/>"),t.setPosition(i,e),t.el.append(i)}}(this)),this.markers=$(".timeline .marker"),this.markers.first().addClass("current")},t.prototype.initPeople=function(){var t;return t=function(t){return function(e){var i,n,r;return i=$(e).data("person"),n=t.people[i],n.age=moment().diff(moment(n.birthdate),"years"),r=$("#person").html(),Mustache.render(r,n)}}(this),$("a[data-person]").each(function(e,i){return $(i).webuiPopover({content:t(i),trigger:"hover",animation:"pop",placement:"top"})})},t.prototype.setPosition=function(t,e){var i;return i=e.diff(this.start_date)/this.scale,t.css("left",i)},t}()}).call(this);