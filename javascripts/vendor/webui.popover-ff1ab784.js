!function(t,e,i){"use strict";function o(e,i){this.$element=t(e),i&&("string"===t.type(i.delay)||"number"===t.type(i.delay))&&(i.delay={show:i.delay,hide:i.delay}),this.options=t.extend({},r,i),this._defaults=r,this._name=s,this._targetclick=!1,this.init(),a.push(this.$element)}var s="webuiPopover",n="webui-popover",h="webui.popover",r={placement:"auto",width:"auto",height:"auto",trigger:"click",style:"",delay:{show:null,hide:null},async:{before:null,success:null},cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",constrains:null,animation:null,template:'<div class="webui-popover"><div class="arrow"></div><div class="webui-popover-inner"><a href="#" class="close">x</a><h3 class="webui-popover-title"></h3><div class="webui-popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null},a=[],l=t('<div class="webui-popover-backdrop"></div>'),p=0,c=t(i);o.prototype={init:function(){"click"===this.getTrigger()?this.$element.off("click").on("click",t.proxy(this.toggle,this)):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave click").on("mouseenter",t.proxy(this.mouseenterHandler,this)).on("mouseleave",t.proxy(this.mouseleaveHandler,this)),this._poped=!1,this._inited=!0,this._opened=!1,this._idSeed=p,this.options.backdrop&&l.appendTo(i.body).hide(),p++},destroy:function(){for(var t=-1,e=0;e<a.length;e++)if(a[e]===this.$element){t=e;break}a.splice(t,1),this.hide(),this.$element.data("plugin_"+s,null),"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave"),this.$target&&this.$target.remove()},hide:function(e){if(this._opened){e&&(e.preventDefault(),e.stopPropagation()),this.xhr&&(this.xhr.abort(),this.xhr=null);var i=t.Event("hide."+h);this.$element.trigger(i),this.$target&&this.$target.removeClass("in").hide(),this.options.backdrop&&l.hide(),this._opened=!1,this.$element.trigger("hidden."+h),this.options.onHide&&this.options.onHide(this.$target)}},toggle:function(t){t&&(t.preventDefault(),t.stopPropagation()),this[this.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){for(var t=0;t<a.length;t++)a[t].webuiPopover("hide");c.trigger("hiddenAll."+h)},show:function(){var t=this.getTarget().removeClass().addClass(n).addClass(this._customTargetClass);this.options.multi||this.hideAll(),this._opened||(this.getCache()&&this._poped&&""!==this.content||(this.content="",this.setTitle(this.getTitle()),this.options.closeable||t.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),t.show()),this.displayContent(),this.options.onShow&&this.options.onShow(t),this.bindBodyEvents(),this.options.backdrop&&l.show(),this._opened=!0)},displayContent:function(){var e=this.getElementPosition(),o=this.getTarget().removeClass().addClass(n).addClass(this._customTargetClass),s=this.getContentElement(),r=o[0].offsetWidth,a=o[0].offsetHeight,l="bottom",p=t.Event("show."+h);this.$element.trigger(p),"auto"!==this.options.width&&o.width(this.options.width),"auto"!==this.options.height&&s.height(this.options.height),this.options.arrow||o.find(".arrow").remove(),o.detach().css({top:-2e3,left:-2e3,display:"block"}),this.getAnimation()&&o.addClass(this.getAnimation()),o.appendTo(i.body),r=o[0].offsetWidth,a=o[0].offsetHeight,l=this.getPlacement(e),this.initTargetEvents();var c=this.getTargetPositin(e,l,r,a);if(this.$target.css(c.position).addClass(l).addClass("in"),"iframe"===this.options.type){var g=o.find("iframe");g.width(o.width()).height(g.parent().height())}if(this.options.style&&this.$target.addClass(n+"-"+this.options.style),this.options.padding||(s.css("height",s.outerHeight()),this.$target.addClass("webui-no-padding")),this.options.arrow||this.$target.css({margin:0}),this.options.arrow){var d=this.$target.find(".arrow");d.removeAttr("style"),c.arrowOffset&&d.css(c.arrowOffset)}this._poped=!0,this.$element.trigger("shown."+h)},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var e=s+this._idSeed;this.$target=t(this.options.template).attr("id",e).data("trigger-element",this.getTriggerElement()),this._customTargetClass=this.$target.attr("class")!==n?this.$target.attr("class"):null,this.getTriggerElement().attr("data-target",e)}return this.$target},getTitleElement:function(){return this.getTarget().find("."+n+"-title")},getContentElement:function(){return this.getTarget().find("."+n+"-content")},getTitle:function(){return this.$element.attr("data-title")||this.options.title||this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getCache:function(){var t=this.$element.attr("data-cache");if("undefined"!=typeof t)switch(t.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var t=this.$element.attr("data-delay-show");return"undefined"!=typeof t?t:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var t=this.$element.attr("data-delay-hide");return"undefined"!=typeof t?t:0===this.options.delay.hide?0:this.options.delay.hide||100},getConstrains:function(){var t=this.$element.attr("data-contrains");return"undefined"!=typeof t?t:this.options.constrains},getAnimation:function(){var t=this.$element.attr("data-animation");return t||this.options.animation},setTitle:function(t){var e=this.getTitleElement();t?e.html(t):e.remove()},hasContent:function(){return this.getContent()},getContent:function(){if(this.getUrl())"iframe"===this.options.type&&(this.content=t('<iframe frameborder="0"></iframe>').attr("src",this.getUrl()));else if(!this.content){var e="";e=t.isFunction(this.options.content)?this.options.content.apply(this.$element[0],arguments):this.options.content,this.content=this.$element.attr("data-content")||e}return this.content},setContent:function(t){var e=this.getTarget();this.getContentElement().html(t),this.$target=e},isAsync:function(){return"async"===this.options.type},setContentASync:function(e){var i=this;this.xhr=t.ajax({url:this.getUrl(),type:"GET",cache:this.getCache(),beforeSend:function(t){i.options.async.before&&i.options.async.before(i,t)},success:function(o){i.bindBodyEvents(),i.content=e&&t.isFunction(e)?e.apply(i.$element[0],[o]):o,i.setContent(i.content);var s=i.getContentElement();s.removeAttr("style"),i.displayContent(),i.options.async.success&&i.options.async.success(i,o),this.xhr=null}})},bindBodyEvents:function(){this.options.dismissible&&(t("body").off("keyup.webui-popover").on("keyup.webui-popover",t.proxy(this.escapeHandler,this)),t("body").off("click.webui-popover").on("click.webui-popover",t.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(){var t=this;t._timeout&&clearTimeout(t._timeout),t._enterTimeout=setTimeout(function(){t.getTarget().is(":visible")||t.show()},this.getDelayShow())},mouseleaveHandler:function(){var t=this;clearTimeout(t._enterTimeout),t._timeout=setTimeout(function(){t.hide()},this.getHideDelay())},escapeHandler:function(t){27===t.keyCode&&this.hideAll()},bodyClickHandler:function(){"click"===this.getTrigger()&&(this._targetclick?this._targetclick=!1:this.hideAll())},targetClickHandler:function(){this._targetclick=!0},initTargetEvents:function(){"hover"===this.getTrigger()&&this.$target.off("mouseenter mouseleave").on("mouseenter",t.proxy(this.mouseenterHandler,this)).on("mouseleave",t.proxy(this.mouseleaveHandler,this)),this.$target.find(".close").off("click").on("click",t.proxy(this.hide,this)),this.$target.off("click.webui-popover").on("click.webui-popover",t.proxy(this.targetClickHandler,this))},getPlacement:function(t){var e,o=i.documentElement,s=i.body,n=o.clientWidth,h=o.clientHeight,r=Math.max(s.scrollTop,o.scrollTop),a=Math.max(s.scrollLeft,o.scrollLeft),l=Math.max(0,t.left-a),p=Math.max(0,t.top-r);if(e="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement,"auto"===e){var c="horizontal"===this.getConstrains(),g="vertical"===this.getConstrains();e=n/3>l?h/3>p?c?"right-bottom":"bottom-right":2*h/3>p?g?h/2>=p?"bottom-right":"top-right":"right":c?"right-top":"top-right":2*n/3>l?h/3>p?c?n/2>=l?"right-bottom":"left-bottom":"bottom":2*h/3>p?c?n/2>=l?"right":"left":h/2>=p?"bottom":"top":c?n/2>=l?"right-top":"left-top":"top":h/3>p?c?"left-bottom":"bottom-left":2*h/3>p?g?h/2>=p?"bottom-left":"top-left":"left":c?"left-top":"top-left"}else"auto-top"===e?e=n/3>l?"top-right":2*h/3>l?"top":"top-left":"auto-bottom"===e?e=n/3>l?"bottom-right":2*h/3>l?"bottom":"bottom-left":"auto-left"===e?e=h/3>p?"left-top":2*h/3>p?"left":"left-bottom":"auto-right"===e&&(e=h/3>p?"right-top":2*h/3>p?"right":"right-bottom");return e},getElementPosition:function(){return t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTargetPositin:function(t,e,i,o){var s=t,n=this.$element.outerWidth(),h=this.$element.outerHeight(),r={},a=null,l=this.options.arrow?20:0,p=l+10>n?l:0,c=l+10>h?l:0;switch(e){case"bottom":r={top:s.top+s.height,left:s.left+s.width/2-i/2};break;case"top":r={top:s.top-o,left:s.left+s.width/2-i/2};break;case"left":r={top:s.top+s.height/2-o/2,left:s.left-i};break;case"right":r={top:s.top+s.height/2-o/2,left:s.left+s.width};break;case"top-right":r={top:s.top-o,left:s.left-p},a={left:Math.min(n,i)/2+p};break;case"top-left":r={top:s.top-o,left:s.left-i+s.width+p},a={left:i-Math.min(n,i)/2-p};break;case"bottom-right":r={top:s.top+s.height,left:s.left-p},a={left:Math.min(n,i)/2+p};break;case"bottom-left":r={top:s.top+s.height,left:s.left-i+s.width+p},a={left:i-Math.min(n,i)/2-p};break;case"right-top":r={top:s.top-o+s.height+c,left:s.left+s.width},a={top:o-Math.min(h,o)/2-c};break;case"right-bottom":r={top:s.top-c,left:s.left+s.width},a={top:Math.min(h,o)/2+c};break;case"left-top":r={top:s.top-o+s.height+c,left:s.left-i},a={top:o-Math.min(h,o)/2-c};break;case"left-bottom":r={top:s.top-c,left:s.left-i},a={top:Math.min(h,o)/2+c}}return{position:r,arrowOffset:a}}},t.fn[s]=function(e,i){var n=[],h=this.each(function(){var h=t.data(this,"plugin_"+s);h?"destroy"===e?h.destroy():"string"==typeof e&&n.push(h[e]()):(e?"string"==typeof e?"destroy"!==e&&(i||(h=new o(this,null),n.push(h[e]()))):"object"==typeof e&&(h=new o(this,e)):h=new o(this,null),t.data(this,"plugin_"+s,h))});return n.length?n:h}}(jQuery,window,document);